{
  "domains": {
    "Secret": {
      "name": "Secret",
      "description": "Core entity storing sensitive data (API keys, tokens, credentials). Has name, encrypted value, tags, and timestamps. Secrets are encrypted at rest with AES-256-GCM.",
      "files": [
        "src/vault/vault.ts"
      ],
      "timestamp": "2026-01-21T12:50:58.285Z"
    },
    "Vault": {
      "name": "Vault",
      "description": "Encrypted SQLite database storing secrets. Supports local (.psst/) and global (~/.psst/) locations. Contains secrets table with encryption keys managed by OS keychain.",
      "files": [
        "src/vault/vault.ts"
      ],
      "timestamp": "2026-01-21T12:50:58.442Z"
    },
    "Environment": {
      "name": "Environment",
      "description": "Logical separation of secrets (dev, staging, prod). Each environment has its own vault database. Default environment is 'default'.",
      "files": [
        "src/vault/vault.ts",
        "src/commands/list-envs.ts"
      ],
      "timestamp": "2026-01-21T12:50:58.593Z"
    },
    "Tag": {
      "name": "Tag",
      "description": "String labels for organizing and filtering secrets. Secrets can have multiple tags. Used for selective injection (e.g., --tag aws injects only AWS-related secrets).",
      "files": [
        "src/vault/vault.ts",
        "src/commands/tag.ts"
      ],
      "timestamp": "2026-01-21T12:50:58.738Z"
    },
    "EncryptionKey": {
      "name": "EncryptionKey",
      "description": "256-bit key for AES-256-GCM encryption. Stored in OS keychain (macOS Keychain, Linux libsecret, Windows Credential Manager). Never exposed to agents.",
      "files": [
        "src/vault/keychain.ts",
        "src/vault/crypto.ts"
      ],
      "timestamp": "2026-01-21T12:50:58.897Z"
    },
    "Command": {
      "name": "Command",
      "description": "CLI subcommand (init, set, get, list, rm, exec, run, scan, etc.). Each command operates on vault/secrets. Follows consistent async function signature with OutputOptions.",
      "files": [
        "src/main.ts",
        "src/commands/"
      ],
      "timestamp": "2026-01-21T12:50:59.037Z"
    }
  },
  "capabilities": {
    "InitializeVault": {
      "name": "InitializeVault",
      "description": "Creates vault directory and SQLite database. Generates encryption key and stores in OS keychain. Supports local and global modes.",
      "operates_on": [
        "Vault",
        "EncryptionKey",
        "Environment"
      ],
      "files": [
        "src/commands/init.ts"
      ],
      "timestamp": "2026-01-21T12:51:17.463Z"
    },
    "SetSecret": {
      "name": "SetSecret",
      "description": "Creates or updates a secret in the vault. Encrypts value with AES-256-GCM. Validates name format (uppercase with underscores). Supports stdin input and tags.",
      "operates_on": [
        "Secret",
        "Vault",
        "Tag"
      ],
      "files": [
        "src/commands/set.ts"
      ],
      "timestamp": "2026-01-21T12:51:17.618Z"
    },
    "GetSecret": {
      "name": "GetSecret",
      "description": "Retrieves and decrypts a secret value. Intended for human debugging, not for agents. Returns raw plaintext value.",
      "operates_on": [
        "Secret",
        "Vault"
      ],
      "files": [
        "src/commands/get.ts"
      ],
      "timestamp": "2026-01-21T12:51:17.777Z"
    },
    "ListSecrets": {
      "name": "ListSecrets",
      "description": "Lists secret names and metadata without exposing values. Supports filtering by tags. Returns SecretMeta (name, tags, timestamps).",
      "operates_on": [
        "Secret",
        "Vault",
        "Tag"
      ],
      "files": [
        "src/commands/list.ts"
      ],
      "timestamp": "2026-01-21T12:51:17.981Z"
    },
    "RemoveSecret": {
      "name": "RemoveSecret",
      "description": "Deletes a secret from the vault. Permanent operation.",
      "operates_on": [
        "Secret",
        "Vault"
      ],
      "files": [
        "src/commands/rm.ts"
      ],
      "timestamp": "2026-01-21T12:51:18.147Z"
    },
    "ExecuteWithSecrets": {
      "name": "ExecuteWithSecrets",
      "description": "Runs a command with specific secrets injected as environment variables. Pattern: psst SECRET1 SECRET2 -- cmd. Masks secret values in output.",
      "operates_on": [
        "Secret",
        "Vault",
        "Command"
      ],
      "files": [
        "src/commands/exec.ts"
      ],
      "timestamp": "2026-01-21T12:51:18.302Z"
    },
    "RunWithAllSecrets": {
      "name": "RunWithAllSecrets",
      "description": "Runs a command with ALL secrets (or tagged subset) injected. Pattern: psst run cmd. Supports --tag filtering.",
      "operates_on": [
        "Secret",
        "Vault",
        "Tag",
        "Command"
      ],
      "files": [
        "src/commands/run.ts"
      ],
      "timestamp": "2026-01-21T12:51:18.454Z"
    },
    "ImportSecrets": {
      "name": "ImportSecrets",
      "description": "Bulk imports secrets from .env files, stdin, or process.env. Parses KEY=value format with quote handling. Supports regex pattern filtering.",
      "operates_on": [
        "Secret",
        "Vault"
      ],
      "files": [
        "src/commands/import.ts"
      ],
      "timestamp": "2026-01-21T12:51:18.606Z"
    },
    "ExportSecrets": {
      "name": "ExportSecrets",
      "description": "Exports secrets to .env file format. Properly escapes shell metacharacters in values. For backup or sharing.",
      "operates_on": [
        "Secret",
        "Vault"
      ],
      "files": [
        "src/commands/export.ts"
      ],
      "timestamp": "2026-01-21T12:51:18.754Z"
    },
    "ManageTags": {
      "name": "ManageTags",
      "description": "Add, remove, or set tags on secrets. Commands: tag, untag. Enables grouping and filtering.",
      "operates_on": [
        "Secret",
        "Tag"
      ],
      "files": [
        "src/commands/tag.ts"
      ],
      "timestamp": "2026-01-21T12:51:18.907Z"
    },
    "ScanForSecrets": {
      "name": "ScanForSecrets",
      "description": "Detects leaked secrets in files by searching for known secret values. Supports --staged for git pre-commit, --path for arbitrary directories. Respects .gitignore.",
      "operates_on": [
        "Secret",
        "Vault"
      ],
      "files": [
        "src/commands/scan.ts"
      ],
      "timestamp": "2026-01-21T12:51:34.948Z"
    },
    "InstallGitHook": {
      "name": "InstallGitHook",
      "description": "Installs pre-commit hook that runs scan --staged. Prevents accidental commits containing secrets.",
      "operates_on": [
        "Vault"
      ],
      "files": [
        "src/commands/install-hook.ts"
      ],
      "timestamp": "2026-01-21T12:51:35.123Z"
    },
    "LockVault": {
      "name": "LockVault",
      "description": "Encrypts vault database at rest with password. Uses PBKDF2 key derivation and AES-GCM file encryption. For backups and travel.",
      "operates_on": [
        "Vault",
        "EncryptionKey"
      ],
      "files": [
        "src/commands/lock.ts"
      ],
      "timestamp": "2026-01-21T12:51:35.306Z"
    },
    "UnlockVault": {
      "name": "UnlockVault",
      "description": "Decrypts a password-locked vault. Prompts for password and restores vault to normal operation.",
      "operates_on": [
        "Vault",
        "EncryptionKey"
      ],
      "files": [
        "src/commands/unlock.ts"
      ],
      "timestamp": "2026-01-21T12:51:35.471Z"
    },
    "ListEnvironments": {
      "name": "ListEnvironments",
      "description": "Lists available environments (both global and local). Shows which environments have vaults.",
      "operates_on": [
        "Environment",
        "Vault"
      ],
      "files": [
        "src/commands/list-envs.ts"
      ],
      "timestamp": "2026-01-21T12:51:35.653Z"
    },
    "OnboardAgent": {
      "name": "OnboardAgent",
      "description": "Adds psst instructions to CLAUDE.md or AGENTS.md. Teaches AI agents how to use psst for secret injection.",
      "operates_on": [
        "Command"
      ],
      "files": [
        "src/commands/onboard.ts"
      ],
      "timestamp": "2026-01-21T12:51:35.820Z"
    },
    "EncryptSecret": {
      "name": "EncryptSecret",
      "description": "AES-256-GCM encryption of secret values. Generates random 12-byte IV per encryption. Authenticated encryption prevents tampering.",
      "operates_on": [
        "Secret",
        "EncryptionKey"
      ],
      "files": [
        "src/vault/crypto.ts"
      ],
      "timestamp": "2026-01-21T12:51:35.985Z"
    },
    "DecryptSecret": {
      "name": "DecryptSecret",
      "description": "AES-256-GCM decryption of stored secrets. Verifies authentication tag to detect tampering.",
      "operates_on": [
        "Secret",
        "EncryptionKey"
      ],
      "files": [
        "src/vault/crypto.ts"
      ],
      "timestamp": "2026-01-21T12:51:36.157Z"
    },
    "ManageKeychain": {
      "name": "ManageKeychain",
      "description": "Stores/retrieves encryption keys from OS keychain. Cross-platform support: macOS security, Linux secret-tool, Windows cmdkey.",
      "operates_on": [
        "EncryptionKey"
      ],
      "files": [
        "src/vault/keychain.ts"
      ],
      "timestamp": "2026-01-21T12:51:36.312Z"
    },
    "MaskOutput": {
      "name": "MaskOutput",
      "description": "Redacts secret values from command output. Replaces occurrences with [MASKED]. Handles special regex characters safely.",
      "operates_on": [
        "Secret"
      ],
      "files": [
        "src/commands/exec.ts"
      ],
      "timestamp": "2026-01-21T12:51:36.470Z"
    }
  },
  "aspects": {
    "Encryption": {
      "name": "Encryption",
      "description": "AES-256-GCM authenticated encryption for secrets at rest. Random IV per encryption, PBKDF2 key derivation for passwords.",
      "applies_to": {
        "capabilities": [
          "SetSecret",
          "GetSecret",
          "EncryptSecret",
          "DecryptSecret",
          "LockVault",
          "UnlockVault"
        ]
      },
      "files": [
        "src/vault/crypto.ts"
      ],
      "timestamp": "2026-01-21T12:51:51.930Z"
    },
    "SecretIsolation": {
      "name": "SecretIsolation",
      "description": "Secrets never exposed to AI agent context. Injected only into subprocess environment. Values redacted from output.",
      "applies_to": {
        "capabilities": [
          "ExecuteWithSecrets",
          "RunWithAllSecrets",
          "MaskOutput"
        ]
      },
      "files": [
        "src/commands/exec.ts",
        "src/commands/run.ts"
      ],
      "timestamp": "2026-01-21T12:51:52.121Z"
    },
    "OutputFormatting": {
      "name": "OutputFormatting",
      "description": "Supports JSON, human-readable, and quiet output modes. Consistent across all commands via OutputOptions interface.",
      "applies_to": {
        "capabilities": [
          "Command",
          "ListSecrets",
          "ListEnvironments",
          "ExportSecrets",
          "ScanForSecrets"
        ]
      },
      "files": [
        "src/utils/output.ts"
      ],
      "timestamp": "2026-01-21T12:51:52.293Z"
    },
    "ExitCodes": {
      "name": "ExitCodes",
      "description": "Semantic exit codes for scripting: 0=success, 1=error, 2=user error, 3=no vault, 4=locked, 5=auth failed.",
      "applies_to": {
        "capabilities": [
          "Command"
        ]
      },
      "files": [
        "src/utils/exit-codes.ts"
      ],
      "timestamp": "2026-01-21T12:51:52.485Z"
    },
    "CrossPlatformKeychain": {
      "name": "CrossPlatformKeychain",
      "description": "OS-specific keychain integration: macOS Keychain.app, Linux libsecret, Windows Credential Manager. Fallback to PSST_PASSWORD env var.",
      "applies_to": {
        "capabilities": [
          "ManageKeychain",
          "EncryptionKey"
        ]
      },
      "files": [
        "src/vault/keychain.ts"
      ],
      "timestamp": "2026-01-21T12:51:52.667Z"
    },
    "LeakPrevention": {
      "name": "LeakPrevention",
      "description": "Pre-commit hooks and scanning to prevent accidental secret commits. Searches files for known secret values.",
      "applies_to": {
        "capabilities": [
          "ScanForSecrets",
          "InstallGitHook"
        ]
      },
      "files": [
        "src/commands/scan.ts",
        "src/commands/install-hook.ts"
      ],
      "timestamp": "2026-01-21T12:51:52.899Z"
    }
  },
  "decisions": {
    "dec-1768999931998": {
      "id": "dec-1768999931998",
      "what": "Use Bun runtime instead of Node.js",
      "why": "Single binary distribution via bun build --compile. Faster startup, built-in SQLite, simpler deployment for CLI tool.",
      "when": "2026-01-21T12:52:11.998Z",
      "status": "active",
      "relates_to": {}
    },
    "dec-1768999932201": {
      "id": "dec-1768999932201",
      "what": "Local-first with no cloud dependencies",
      "why": "AI agents work offline. No network calls means no risk of sending secrets externally. Zero third-party trust required.",
      "when": "2026-01-21T12:52:12.201Z",
      "status": "active",
      "relates_to": {}
    },
    "dec-1768999932390": {
      "id": "dec-1768999932390",
      "what": "OS keychain for key storage",
      "why": "Leverages existing secure storage. No password prompts for normal operation. Keys never written to disk unprotected.",
      "when": "2026-01-21T12:52:12.390Z",
      "status": "active",
      "relates_to": {}
    },
    "dec-1768999932576": {
      "id": "dec-1768999932576",
      "what": "Subprocess injection instead of exposing values",
      "why": "Core security model: agents reference secrets by name but never see values. Secrets injected at execution time only.",
      "when": "2026-01-21T12:52:12.576Z",
      "status": "active",
      "relates_to": {}
    },
    "dec-1768999932764": {
      "id": "dec-1768999932764",
      "what": "AES-256-GCM for encryption",
      "why": "NIST standard authenticated encryption. Prevents tampering. Random IV per encryption prevents pattern analysis.",
      "when": "2026-01-21T12:52:12.764Z",
      "status": "active",
      "relates_to": {}
    },
    "dec-1768999932956": {
      "id": "dec-1768999932956",
      "what": "SQLite for vault storage",
      "why": "Single-file database. No server needed. Built into Bun runtime. ACID compliance for data integrity.",
      "when": "2026-01-21T12:52:12.956Z",
      "status": "active",
      "relates_to": {}
    },
    "dec-1768999933142": {
      "id": "dec-1768999933142",
      "what": "Manual argument parsing instead of CLI framework",
      "why": "Zero dependencies for core CLI. Full control over command syntax including special patterns like 'psst SECRET -- cmd'.",
      "when": "2026-01-21T12:52:13.142Z",
      "status": "active",
      "relates_to": {}
    },
    "dec-1768999933343": {
      "id": "dec-1768999933343",
      "what": "Support multiple environments",
      "why": "Developers need separate secrets for dev/staging/prod. Each environment is isolated with its own vault database.",
      "when": "2026-01-21T12:52:13.343Z",
      "status": "active",
      "relates_to": {}
    },
    "dec-1768999933542": {
      "id": "dec-1768999933542",
      "what": "Automatic output masking by default",
      "why": "Defense in depth: even if secrets leak to stdout/stderr, they're redacted. Can disable with --no-mask for debugging.",
      "when": "2026-01-21T12:52:13.542Z",
      "status": "active",
      "relates_to": {}
    },
    "dec-1768999933762": {
      "id": "dec-1768999933762",
      "what": "Tag-based grouping for secrets",
      "why": "Enables selective injection (inject only 'aws' tagged secrets). Better organization than flat lists. Multiple tags per secret.",
      "when": "2026-01-21T12:52:13.762Z",
      "status": "active",
      "relates_to": {}
    }
  },
  "version": "0.1.0",
  "lastUpdated": "2026-01-21T12:52:13.762Z",
  "github": {
    "owner": "Michaelliv",
    "repo": "psst",
    "branch": "main"
  },
  "embeddedDocs": {}
}